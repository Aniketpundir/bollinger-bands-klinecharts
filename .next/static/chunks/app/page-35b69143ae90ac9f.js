(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{772:function(e,l,s){Promise.resolve().then(s.bind(s,6356))},6356:function(e,l,s){"use strict";s.r(l),s.d(l,{default:function(){return h}});var a=s(7437),t=s(2265);function n(e,l){let s=e.map(e=>e.close),a=function(e,l){let s=Array(e.length).fill(null);if(l<=0)return s;let a=0;for(let t=0;t<e.length;t++)a+=e[t],t>=l&&(a-=e[t-l]),t>=l-1&&(s[t]=a/l);return s}(s,l.length),t=function(e,l){let s=Array(e.length).fill(null);if(l<=0)return s;let a=0,t=0;for(let n=0;n<e.length;n++){let i=e[n];if(a+=i,t+=i*i,n>=l){let s=e[n-l];a-=s,t-=s*s}if(n>=l-1){let e=a/l,i=t/l-e*e;s[n]=Math.sqrt(Math.max(i,0))}}return s}(s,l.length),n=e.map((e,s)=>{let n=a[s],i=t[s];if(null==n||null==i)return{time:e.timestamp,basis:null,upper:null,lower:null};let r=n+l.stdDev*i,c=n-l.stdDev*i;return{time:e.timestamp,basis:n,upper:r,lower:c}}),i=0|l.offset;return 0===i?n:n.map((e,l,s)=>{let a=l-i;return a<0||a>=s.length?{time:e.time,basis:null,upper:null,lower:null}:{time:e.time,basis:s[a].basis,upper:s[a].upper,lower:s[a].lower}})}var i=s(8785);function r(e){return{timestamp:e.timestamp,open:e.open,high:e.high,low:e.low,close:e.close,volume:e.volume}}function c(e){let{data:l,inputs:s,style:c,onHover:o}=e,u=(0,t.useRef)(null),d=(0,t.useRef)(null),p=(0,t.useRef)(null),h=(0,t.useRef)(null);return(0,t.useEffect)(()=>{if(!u.current)return;let e=(0,i.S1)(u.current,{styles:{candle:{upColor:"#22c55e",downColor:"#ef4444"}}});d.current=e,e.applyNewData(l.map(r)),e.setLocale("en-US"),e.setTimezone("Asia/Kolkata");let a=e=>{var a;if(!o)return;if((null==e?void 0:e.dataIndex)==null){o(null);return}let t=e.dataIndex,i=null!==(a=n(l,s)[t])&&void 0!==a?a:null;o(i&&null!=i.basis?i:null)};e.subscribeAction("crosshair",a);let t=()=>e.resize();return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t),e.unsubscribeAction("crosshair",a),(0,i.B9)(e)}},[]),(0,t.useEffect)(()=>{var e;null===(e=d.current)||void 0===e||e.applyNewData(l.map(r))},[l]),(0,t.useEffect)(()=>{let e=d.current;if(!e)return;let a=n(l,s),t=a.map(e=>{var l;return{timestamp:e.time,value:null!==(l=e.basis)&&void 0!==l?l:null}}),i=a.map(e=>{var l;return{timestamp:e.time,value:null!==(l=e.upper)&&void 0!==l?l:null}}),r=a.map(e=>{var l;return{timestamp:e.time,value:null!==(l=e.lower)&&void 0!==l?l:null}});if(p.current&&e.removeOverlay(p.current),h.current&&e.removeOverlay(h.current),c.fillBetween){let l=e.createOverlay({name:"polygon",lock:!0,points:[...i.filter(e=>null!=e.value),...r.filter(e=>null!=e.value).reverse()],styles:{style:"stroke_fill",borderColor:"transparent",color:"rgba(99, 102, 241, ".concat(Math.min(Math.max(c.fillOpacity,0),1),")")}});h.current=l}let o=null;if(c.showBasis){let l=e.createOverlay({name:"polyline",lock:!0,points:t.filter(e=>null!=e.value),styles:{color:c.basisColor,size:c.basisWidth,style:"dashed"===c.basisStyle?"dashed":"solid"}});o||(o=l)}if(c.showUpper){let l=e.createOverlay({name:"polyline",lock:!0,points:i.filter(e=>null!=e.value),styles:{color:c.upperColor,size:c.upperWidth,style:"dashed"===c.upperStyle?"dashed":"solid"}});o||(o=l)}if(c.showLower){let l=e.createOverlay({name:"polyline",lock:!0,points:r.filter(e=>null!=e.value),styles:{color:c.lowerColor,size:c.lowerWidth,style:"dashed"===c.lowerStyle?"dashed":"solid"}});o||(o=l)}p.current=o},[l,s,c]),(0,a.jsx)("div",{className:"h-[70vh] w-full rounded-2xl overflow-hidden",ref:u})}let o=e=>{let{value:l,onChange:s}=e;return(0,a.jsxs)("select",{className:"select",value:l,onChange:e=>s(e.target.value),children:[(0,a.jsx)("option",{value:"solid",children:"Solid"}),(0,a.jsx)("option",{value:"dashed",children:"Dashed"})]})};function u(e){let{open:l,onClose:s,inputs:n,style:i,onChangeInputs:r,onChangeStyle:c}=e,[u,d]=(0,t.useState)("Inputs");return((0,t.useEffect)(()=>{l||d("Inputs")},[l]),l)?(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60",children:(0,a.jsxs)("div",{className:"card w-[680px] max-w-[95vw]",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("div",{className:"text-lg font-semibold",children:"Bollinger Bands — Settings"}),(0,a.jsx)("button",{className:"btn-outline",onClick:s,children:"✕"})]}),(0,a.jsx)("div",{className:"mb-4 border-b border-white/10 flex gap-2",children:["Inputs","Style"].map(e=>(0,a.jsx)("button",{className:"px-3 py-2 ".concat(u===e?"border-b-2 border-blue-400":"text-white/60"),onClick:()=>d(e),children:e},e))}),"Inputs"===u&&(0,a.jsxs)("div",{className:"grid grid-cols-form gap-3",children:[(0,a.jsx)("label",{className:"label",children:"Length"}),(0,a.jsx)("input",{className:"input",type:"number",min:1,value:n.length,onChange:e=>r({...n,length:parseInt(e.target.value||"20",10)})}),(0,a.jsx)("label",{className:"label",children:"MA Type"}),(0,a.jsx)("select",{className:"select",value:n.maType,onChange:e=>r({...n,maType:e.target.value}),children:(0,a.jsx)("option",{value:"SMA",children:"SMA"})}),(0,a.jsx)("label",{className:"label",children:"Source"}),(0,a.jsx)("select",{className:"select",value:n.source,onChange:e=>r({...n,source:e.target.value}),children:(0,a.jsx)("option",{value:"close",children:"Close"})}),(0,a.jsx)("label",{className:"label",children:"StdDev"}),(0,a.jsx)("input",{className:"input",type:"number",step:"0.1",value:n.stdDev,onChange:e=>r({...n,stdDev:parseFloat(e.target.value||"2")})}),(0,a.jsx)("label",{className:"label",children:"Offset"}),(0,a.jsx)("input",{className:"input",type:"number",step:"1",value:n.offset,onChange:e=>r({...n,offset:parseInt(e.target.value||"0",10)})})]}),"Style"===u&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,a.jsx)("div",{className:"col-span-3 text-sm font-semibold opacity-80",children:"Middle (Basis)"}),(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",className:"checkbox",checked:i.showBasis,onChange:e=>c({...i,showBasis:e.target.checked})})," ",(0,a.jsx)("span",{className:"label",children:"Visible"})]}),(0,a.jsx)("input",{type:"color",value:i.basisColor,onChange:e=>c({...i,basisColor:e.target.value})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"label",children:"Width"}),(0,a.jsx)("input",{type:"number",className:"input w-20",min:1,max:4,value:i.basisWidth,onChange:e=>c({...i,basisWidth:parseInt(e.target.value||"1",10)})})]}),(0,a.jsx)("div",{className:"col-span-3",children:(0,a.jsx)(o,{value:i.basisStyle,onChange:e=>c({...i,basisStyle:e})})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,a.jsx)("div",{className:"col-span-3 text-sm font-semibold opacity-80",children:"Upper"}),(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",className:"checkbox",checked:i.showUpper,onChange:e=>c({...i,showUpper:e.target.checked})})," ",(0,a.jsx)("span",{className:"label",children:"Visible"})]}),(0,a.jsx)("input",{type:"color",value:i.upperColor,onChange:e=>c({...i,upperColor:e.target.value})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"label",children:"Width"}),(0,a.jsx)("input",{type:"number",className:"input w-20",min:1,max:4,value:i.upperWidth,onChange:e=>c({...i,upperWidth:parseInt(e.target.value||"1",10)})})]}),(0,a.jsx)("div",{className:"col-span-3",children:(0,a.jsx)(o,{value:i.upperStyle,onChange:e=>c({...i,upperStyle:e})})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,a.jsx)("div",{className:"col-span-3 text-sm font-semibold opacity-80",children:"Lower"}),(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",className:"checkbox",checked:i.showLower,onChange:e=>c({...i,showLower:e.target.checked})})," ",(0,a.jsx)("span",{className:"label",children:"Visible"})]}),(0,a.jsx)("input",{type:"color",value:i.lowerColor,onChange:e=>c({...i,lowerColor:e.target.value})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"label",children:"Width"}),(0,a.jsx)("input",{type:"number",className:"input w-20",min:1,max:4,value:i.lowerWidth,onChange:e=>c({...i,lowerWidth:parseInt(e.target.value||"1",10)})})]}),(0,a.jsx)("div",{className:"col-span-3",children:(0,a.jsx)(o,{value:i.lowerStyle,onChange:e=>c({...i,lowerStyle:e})})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,a.jsx)("div",{className:"col-span-3 text-sm font-semibold opacity-80",children:"Background Fill"}),(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",className:"checkbox",checked:i.fillBetween,onChange:e=>c({...i,fillBetween:e.target.checked})})," ",(0,a.jsx)("span",{className:"label",children:"Visible"})]}),(0,a.jsxs)("div",{className:"col-span-2 flex items-center gap-2",children:[(0,a.jsx)("span",{className:"label",children:"Opacity"}),(0,a.jsx)("input",{type:"range",min:0,max:1,step:.05,value:i.fillOpacity,onChange:e=>c({...i,fillOpacity:parseFloat(e.target.value)})}),(0,a.jsxs)("span",{className:"text-sm",children:[Math.round(100*i.fillOpacity),"%"]})]})]})]}),(0,a.jsx)("div",{className:"flex justify-end mt-6",children:(0,a.jsx)("button",{className:"btn-primary",onClick:s,children:"Close"})})]})}):null}let d={length:20,source:"close",maType:"SMA",stdDev:2,offset:0},p={showBasis:!0,basisColor:"#60a5fa",basisWidth:1,basisStyle:"solid",showUpper:!0,upperColor:"#a78bfa",upperWidth:1,upperStyle:"solid",showLower:!0,lowerColor:"#34d399",lowerWidth:1,lowerStyle:"solid",fillBetween:!0,fillOpacity:.12};function h(){var e,l,s;let[n,i]=(0,t.useState)([]),[r,o]=(0,t.useState)(d),[h,m]=(0,t.useState)(p),[x,v]=(0,t.useState)(!1),[f,b]=(0,t.useState)(null);return(0,t.useEffect)(()=>{fetch("/data/ohlcv.json").then(e=>e.json()).then(i)},[]),(0,a.jsxs)("main",{className:"p-6 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h1",{className:"text-xl font-semibold",children:"FindScan — Bollinger Bands (KLineCharts)"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{className:"btn-outline",onClick:()=>v(!0),children:"⚙️ Settings"}),(0,a.jsx)("a",{href:"https://klinecharts.com/en-US/",target:"_blank",className:"btn-outline",children:"KLineCharts Docs ↗"})]})]}),(0,a.jsx)("div",{className:"card",children:(0,a.jsx)(c,{data:n,inputs:r,style:h,onHover:b})}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("div",{className:"text-sm opacity-80",children:"Tooltip (hover candle)"}),f?(0,a.jsxs)("div",{className:"text-sm mt-1",children:[(0,a.jsxs)("span",{className:"mr-4",children:["Basis: ",(0,a.jsx)("b",{children:null===(e=f.basis)||void 0===e?void 0:e.toFixed(2)})]}),(0,a.jsxs)("span",{className:"mr-4",children:["Upper: ",(0,a.jsx)("b",{children:null===(l=f.upper)||void 0===l?void 0:l.toFixed(2)})]}),(0,a.jsxs)("span",{children:["Lower: ",(0,a.jsx)("b",{children:null===(s=f.lower)||void 0===s?void 0:s.toFixed(2)})]})]}):(0,a.jsx)("div",{className:"text-sm mt-1 opacity-60",children:"Move crosshair over a candle to see values…"})]}),(0,a.jsx)(u,{open:x,onClose:()=>v(!1),inputs:r,style:h,onChangeInputs:o,onChangeStyle:m})]})}}},function(e){e.O(0,[372,971,23,744],function(){return e(e.s=772)}),_N_E=e.O()}]);